<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Replace Refactorings</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Replace Refactorings</h1>
    </header>
<nav class="sidebar">
    <!--<h2>Menu</h2>-->
    <ul>
        <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
        <li><a href="replace.html"><i class="fas fa-exchange-alt"></i> Replace</a></li>
        <li><a href="interface.html"><i class="fas fa-handshake"></i> Interface Protocol</a></li>
        <li><a href="addition.html"><i class="fas fa-plus-circle"></i> Addition</a></li>
        <li><a href="remove.html"><i class="fas fa-minus-circle"></i> Remove</a></li>
        <li><a href="merge.html"><i class="fas fa-object-group"></i> Merge</a></li>
    </ul>
</nav>

    <main>
        <section>
            <h2>List of Replace Refactorings</h2>

            <!-- Accordion style -->
            <div class="accordion">
                <div class="accordion-item">
                    <button class="accordion-header">Replace ‘expected’ attribute with try-catch</button>
                    <div class="accordion-content">
                         <p><strong>Definition:</strong> Replace the <code>expected</code> attribute in <code>@Test</code> with an explicit try-catch block to handle the exception.</p>
      
      <pre><code class="language-java">
- @Test(expected = AssumptionViolatedException.class) 
+ @Test
  public void assumeThatWorks() {
-     assumeThat(1, is(2));
+     try {
+         assumeThat(1, is(2));
+         fail("should throw AssumptionViolatedException");
+     } catch (AssumptionViolatedException e) {
+         // expected
+     }
  }
      </code></pre>
      <p><strong>Rationale:</strong> Improves clarity, allows assertions on exception details, and ensures compatibility with modern JUnit practices.</p>
	  <p><strong>Reference:</strong><a href="https://github.com/junit-team/junit4/commit/df016dc0" target="_blank"> JUnit 4 Commit Example</a>
                    </div>
                </div>

                <div class="accordion-item">
                    <button class="accordion-header">Replace array with list</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace an array with a <code>List</code> collection to gain flexibility in managing elements.</p>
  
  <pre><code class="language-java">
- X509Certificate jsseCerts[] = null;
+ List&lt;X509Certificate&gt; jsseCerts = new ArrayList&lt;&gt;();
  
  ByteChunk certData = certificates.getByteChunk();
- ByteArrayInputStream bais = new ByteArrayInputStream(
-     certData.getBytes(), certData.getStart(), certData.getLength());
+ ByteArrayInputStream bais =
+     new ByteArrayInputStream(certData.getBytes(), certData.getStart(), certData.getLength());
  </code></pre>
  
  <p><strong>Rationale:</strong> Improves code flexibility by leveraging the <code>List</code> interface, which supports dynamic resizing and convenient APIs, unlike fixed-size arrays.</p>

  <p><strong>Reference:</strong> 
    <a href="https://github.com/apache/tomcat/commit/f650ea788d" target="_blank">Apache Tomcat Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace array with singleton list</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace <code>Arrays.asList()</code> when creating a single-element list with <code>Collections.singletonList()</code> for efficiency and clarity.</p>
  
  <pre><code class="language-java">
- return Arrays.asList(cause);
+ return singletonList(cause);
  </code></pre>
  
  <p><strong>Rationale:</strong> Using <code>singletonList()</code> is more expressive, avoids unnecessary array creation, and clearly communicates the intent of returning a list with exactly one element.</p>

  <p><strong>Reference:</strong> 
    <a href="https://github.com/junit-team/junit4/commit/17a2f117" target="_blank"> JUnit 4 Commit Example  </a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace array list with primitive array</button>
                    <div class="accordion-content">
                         <p><strong>Definition:</strong> Replace an <code>ArrayList</code> with a primitive array when the size is fixed and known in advance.</p>
  
  <pre><code class="language-java">
- ArrayList&lt;String&gt; result = new ArrayList&lt;String&gt;();
-
+ String[] result = new String[to - from];
  for (int j = from; j != to; ++j) {
-     result.add(args[j]);
+     result[j - from] = args[j];
  }
-
- return result.toArray(new String[result.size()]);
+ return result;
  </code></pre>
  
  <p><strong>Rationale:</strong> Improves performance and reduces overhead by avoiding dynamic list management when a fixed-size array is sufficient.</p>

  <p><strong>Reference:</strong> <a href="https://github.com/junit-team/junit4/commit/b052c712" target="_blank"> JUnit 4 Commit Example </a>  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace collections.sort() with list.sort()</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace <code>Collections.sort()</code> with the instance method <code>List.sort()</code> for improved readability and modern API usage.</p>
  
  <pre><code class="language-java">
- Collections.sort(this.filters, Comparator.comparing(KeyedFilter::key));
+ this.filters.sort(Comparator.comparing(KeyedFilter::key));
  </code></pre>
  
  <p><strong>Rationale:</strong> Enhances code clarity by calling sort directly on the list, reduces verbosity, and aligns with modern Java practices introduced in Java 8.</p>

  <p><strong>Reference:</strong> <a href="https://github.com/elastic/elasticsearch/commit/850e88c5894" target="_blank"> ElasticSearch Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace customized methods with API</button>
                    <div class="accordion-content">
                      <p><strong>Definition:</strong> Replace a manually composed method chain with a built-in API method that provides the same functionality more directly.</p>
  
  <pre><code class="language-java">
- flux.filter(t -> t instanceof MultipartParser.BodyToken)
-     .cast(MultipartParser.BodyToken.class);
+ flux.ofType(MultipartParser.BodyToken.class);
  </code></pre>
  
  <p><strong>Rationale:</strong> Simplifies the code by using a dedicated API method, improving readability, reducing boilerplate, and making intent clearer.</p>

  <p><strong>Reference:</strong><a href="https://github.com/spring-projects/spring-framework/commit/d96a63944c" target="_blank">SpringFramework Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace for with while </button>
                    <div class="accordion-content">
                        <p><strong>Definition:</strong> Replace an enhanced <code>for</code>-loop with a <code>while</code>-loop using an iterator to gain finer control over iteration.</p>
  
  <pre><code class="language-java">
- Map&lt;String, Mapper&gt; mergedMappers = null;
- for (Mapper mergeWithMapper : mergeWith) {
-     Mapper mergeIntoMapper = (mergedMappers == null ? existing.mappers : mergedMappers)
-         .get(mergeWithMapper.simpleName());
+ Iterator&lt;Mapper&gt; iterator = mergeWith.iterator();
+ if (iterator.hasNext() == false) {
+     return Map.copyOf(existing.mappers);
+ }
+ Map&lt;String, Mapper&gt; mergedMappers = new HashMap&lt;&gt;(existing.mappers);
+ while (iterator.hasNext()) {
+     Mapper mergeWithMapper = iterator.next();
+     Mapper mergeIntoMapper = mergedMappers.get(mergeWithMapper.simpleName());
  </code></pre>
  
  <p><strong>Rationale:</strong> Provides greater flexibility by explicitly handling iteration with an <code>Iterator</code>, enabling early exits, conditional checks, and easier integration of additional logic.</p>

  <p><strong>Reference:</strong><a href="https://github.com/elastic/elasticsearch/commit/cd38c3a28d4" target="_blank">Elasticsearch Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace HashMap with linkedHashMap</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace <code>HashMap</code> with <code>LinkedHashMap</code> to preserve insertion order of key-value pairs while maintaining similar performance characteristics.</p>
  
  <pre><code class="language-java">
- Map&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkMethod&gt;&gt; methodsForAnnotations =
-     new HashMap&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkMethod&gt;&gt;();
- Map&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkField&gt;&gt; fieldsForAnnotations =
-     new HashMap&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkField&gt;&gt;();
+ Map&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkMethod&gt;&gt; methodsForAnnotations =
+     new LinkedHashMap&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkMethod&gt;&gt;();
+ Map&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkField&gt;&gt; fieldsForAnnotations =
+     new LinkedHashMap&lt;Class&lt;? extends Annotation&gt;, List&lt;FrameworkField&gt;&gt;();
  </code></pre>
  
  <p><strong>Rationale:</strong> Ensures predictable iteration order, which is useful when consistent traversal of elements is required, while retaining the constant-time performance of a hash-based map.</p>

  <p><strong>Reference:</strong><a href="https://github.com/junit-team/junit4/commit/c75dcc28" target="_blank">JUnit 4 Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace inner class with lambda expression </button>
                    <div class="accordion-content">
                        <p><strong>Definition:</strong> Replace an anonymous inner class with a lambda expression to simplify the code and improve readability.</p>  
  <pre><code class="language-java">
- CacheBuilder&lt;Key, BytesReference&gt; cacheBuilder = CacheBuilder.&lt;Key, BytesReference&gt;builder()
-     .setMaximumWeight(sizeInBytes)
-     .weigher((k, v) -&gt; k.ramBytesUsed() + v.ramBytesUsed())
-     .removalListener(this);
+ CacheBuilder&lt;Key, BytesReference&gt; cacheBuilder = CacheBuilder.&lt;Key, BytesReference&gt;builder()
+     .setMaximumWeight(INDICES_CACHE_QUERY_SIZE.get(settings).getBytes())
+     .weigher((k, v) -&gt; k.ramBytesUsed() + v.ramBytesUsed())
+     .removalListener(notification -&gt; notification.getKey().entity.onRemoval(notification));
  </code></pre>
  
  <p><strong>Rationale:</strong> Simplifies code structure, reduces boilerplate, and enhances readability by using concise lambda expressions instead of verbose inner classes.</p>

  <p><strong>Reference:</strong><a href="https://github.com/elastic/elasticsearch/commit/a5aae93b652" target="_blank">Elasticsearch Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace wrapper object with primitive </button>
                    <div class="accordion-content">
                        <p><strong>Definition:</strong> Replace the use of wrapper objects with primitive arrays when possible to improve performance and reduce unnecessary object creation.</p>
  
  <pre><code class="language-java">
- super(name, NAME, sorts == null ? new String[0] : sorts.stream().map(s -&gt; s.getFieldName()).toArray(String[]::new));
+ super(name, NAME, sorts == null ? new String[0] : sorts.stream().map(FieldSortBuilder::getFieldName).toArray(String[]::new));
  </code></pre>
  
  <p><strong>Rationale:</strong> Reduces memory overhead and improves execution efficiency by avoiding unnecessary wrapper objects and leveraging primitive arrays directly.</p>

  <p><strong>Reference:</strong><a href="https://github.com/elastic/elasticsearch/commit/850e88c5894" target="_blank">Elasticsearch Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace iteration-based retrieval with switch expression</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace iterative lookups over a collection with a Java <code>switch</code> expression for direct mapping of values to results.</p>
  
  <pre><code class="language-java">
- for (Map.Entry&lt;String, Integer&gt; entry : propagationConstants.entrySet()) {
-     if (entry.getValue().equals(propagationBehavior)) {
-         return entry.getKey();
-     }
- }
- throw new IllegalArgumentException("Unsupported propagation behavior: " + propagationBehavior);
+ return switch(propagationBehavior) {
+     case TransactionDefinition.PROPAGATION_REQUIRED -&gt; "PROPAGATION_REQUIRED";
+     case TransactionDefinition.PROPAGATION_SUPPORTS -&gt; "PROPAGATION_SUPPORTS";
+     case TransactionDefinition.PROPAGATION_MANDATORY -&gt; "PROPAGATION_MANDATORY";
+     case TransactionDefinition.PROPAGATION_REQUIRES_NEW -&gt; "PROPAGATION_REQUIRES_NEW";
+     case TransactionDefinition.PROPAGATION_NOT_SUPPORTED -&gt; "PROPAGATION_NOT_SUPPORTED";
+     case TransactionDefinition.PROPAGATION_NEVER -&gt; "PROPAGATION_NEVER";
+     case TransactionDefinition.PROPAGATION_NESTED -&gt; "PROPAGATION_NESTED";
+     default -&gt; throw new IllegalArgumentException("Unsupported propagation behavior: " + propagationBehavior);
+ };
  </code></pre>
  
  <p><strong>Rationale:</strong> Improves readability and efficiency by eliminating explicit loops, making the mapping of input values to results more concise and declarative.</p>

  <p><strong>Reference:</strong><a href="https://github.com/spring-projects/spring-framework/commit/bcff7d74cd" target="_blank">Spring Framework Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace local variable with field</button>
                    <div class="accordion-content">
                         <p><strong>Definition:</strong> Replace a local variable with a class-level field to extend its scope and reuse it across multiple methods.</p>
  
  <pre><code class="language-java">
- DefaultListableBeanFactory beanFactory = new DefaultListableBeanFactory();
- beanFactory.registerSingleton("configuration", new InnerComponentConfiguration());
- compile(beanFactory, beanDefinition, (instanceSupplier, compiled) -&gt; {
-     NoDependencyComponent bean = getBean(beanFactory, beanDefinition, instanceSupplier);
+ this.beanFactory.registerSingleton("configuration", new InnerComponentConfiguration());
+ compile(beanDefinition, (instanceSupplier, compiled) -&gt; {
+     NoDependencyComponent bean = getBean(beanDefinition, instanceSupplier);
  </code></pre>
  
  <p><strong>Rationale:</strong> Increases the accessibility of the object, enabling reuse across methods and reducing repeated instantiation or parameter passing.</p>

  <p><strong>Reference:</strong><a href="https://github.com/spring-projects/spring-framework/commit/35372e5e72" target="_blank"> Spring Framework Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Replace static nested class with inner class</button>
                    <div class="accordion-content">
                       <p><strong>Definition:</strong> Replace a static nested class with a non-static inner class to allow access to the enclosing instance’s fields and methods.</p>
  
  <pre><code class="language-java">
- static final class Search {
+ final class Search {

     static final Predicate&lt;Class&lt;?&gt;&gt; always = clazz -&gt; true;
  </code></pre>
  
  <p><strong>Rationale:</strong> Enables the nested class to reference the outer class instance, facilitating tighter coupling and easier access to instance members when needed.</p>

  <p><strong>Reference:</strong><a href="https://github.com/spring-projects/spring-framework/commit/eafbcfd385" target="_blank">Spring Framework Commit Example</a>
  </p>
                    </div>
                </div>
				
				<div class="accordion-item">
                    <button class="accordion-header">Simplify Source code by using existing data type</button>
                    <div class="accordion-content">
                         <p><strong>Definition:</strong> Simplify code by replacing manual array management with built-in or existing data structures that provide the same functionality.</p>
  
  <pre><code class="language-java">
- synchronized (applicationListenersLock) {
-     String results[] = new String[applicationListeners.length + 1];
-     for (int i = 0; i &lt; applicationListeners.length; i++) {
-         if (listener.equals(applicationListeners[i])) {
-             log.info(sm.getString("standardContext.duplicateListener", listener));
-             return;
-         }
-         results[i] = applicationListeners[i];
-     }
-     results[applicationListeners.length] = listener;
-     applicationListeners = results;
+ if (applicationListeners.addIfAbsent(listener)) {
+     fireContainerEvent("addApplicationListener", listener);
+ } else {
+     log.info(sm.getString("standardContext.duplicateListener", listener));
  }
  </code></pre>
  
  <p><strong>Rationale:</strong> Reduces boilerplate and simplifies code logic by leveraging existing collection methods, improving readability and maintainability.</p>

  <p><strong>Reference:</strong><a href="https://github.com/apache/tomcat/commit/9c09f9abfb" target="_blank">Apache Tomcat Commit Example </a>
  </p>
                    </div>
                </div>
            </div>
        </section>
    </main>

 <script>
document.querySelectorAll('.accordion-header').forEach(button => {
    button.addEventListener('click', () => {
        const content = button.nextElementSibling;

        // Optional: Close all others before opening this one
        document.querySelectorAll('.accordion-content').forEach(panel => {
            if (panel !== content) {
                panel.style.display = 'none';
            }
        });

        // Toggle this one
        if (content.style.display === 'block') {
            content.style.display = 'none';
        } else {
            content.style.display = 'block';
        }
    });
});
</script>
 <footer>
        <p>&copy; 2025 Underexplored Refactorings.</p>
    </footer>
</body>
</html>
